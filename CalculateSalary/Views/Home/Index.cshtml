@{
    ViewBag.Title = "Công cụ tính lương Gross-Net";
}

    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <form>
                    <div class="form-group">
                        <label for="exampleFormControlInput1">
                            Áp dụng quy định
                        </label>
                        <select class="form-control" id="policyApply">
                            <option value="1">Từ 01/07/2022 (Mới nhất)</option>
                            <option value="2">Từ 01/07/2020 - 30/06/2022</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="exampleFormControlInput1">Thu nhập</label>
                        <input  class="form-control" id="salary" placeholder="VD: 10,000,000 (VND) ">

                    </div>
                    <div class="form-group">
                        <label for="exampleFormControlInput1">
                            Mức lương đóng bảo hiểm
                        </label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="calculateOnSalary">
                            <label class="form-check-label" for="defaultCheck1">
                                Trên chính thức
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label" for="defaultCheck1">
                                Khác
                            </label>
                            <input class="form-control" id="salaryInsurance" salaryInsurance="(VND)">

                        </div>
                    </div>
                    <div class="form-group">
                        <label for="exampleFormControlSelect1">Vùng</label>
                        <select class="form-control" id="area">
                            <option value="1">I</option>
                            <option value="2">II</option>
                            <option value="3">III</option>
                            <option value="4">IV</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="exampleFormControlInput1">Số người phụ thuộc</label>
                        <input class="form-control" id="personDependent">
                    </div>

                    <button type="button" id="grossToNet" class="btn btn-primary">GROSS -> NET</button>
                    <button type="button" id="netToGross" class="btn btn-success">NET -> GROSS</button>
                </form>
            </div>
            <div class="col-md-6">
                <div class="bs-example" data-example-id="simple-table">
                    <table class="table">
                        <caption>Bảng tính lương</caption>
                        <thead>
                            <tr>
                                <th>Lương Gross</th>
                                <th>Bảo Hiểm</th>
                                <th>Thuế thu nhập cá nhân</th>
                                <th>Lương NET</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span id="grossSalary"></span></td>
                                <td><span id="insurance"></span></td>
                                <td><span id="tax"></span></td>
                                <td><span id="netSalary"></span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

<script>
    $(document).ready(function () {
        $("#grossToNet").click(function () {
            var valueForm = GetFormValue();
            $.ajax({
                type: "POST",
                url: "/Calculate/GrossToNet",
                data: valueForm,
                success: function (result) {
                    $("#grossSalary").html(FormatNumber(result.GrossSalary));
                    $("#insurance").html(FormatNumber(result.Insurance));
                    $("#tax").html(FormatNumber(result.Tax));
                    $("#netSalary").html(FormatNumber(result.NetSalary));
                }
            });
        });


        $("#netToGross").click(function () {
            var valueForm = GetFormValue();
            $.ajax({
                type: "POST",
                url: "/Calculate/GrossToNet",
                data: valueForm,
                success: function (result) {
                    $("#grossSalary").html(FormatNumber(result.GrossSalary));
                    $("#insurance").html(FormatNumber(result.Insurance));
                    $("#tax").html(FormatNumber(result.Tax));
                    $("#netSalary").html(FormatNumber(result.NetSalary));
                }
            });
        });



        $("#calculateOnSalary").click(function () {
            if ($("#calculateOnSalary").is(':checked')) {
                $("#salaryInsurance").prop('disabled', true);
            }
            else {
                $("#salaryInsurance").prop('disabled', false);
            }
        });

        function GetFormValue() {
            var policyApply = $("#policyApply").val(); 
            var salary = $("#salary").val();
            var calculateOnSalary = $("#calculateOnSalary").is(':checked') ? true : false;
            var salaryInsurance = $("#salaryInsurance").val();
            var area = $("#area").val();
            var personDependent = $("#personDependent").val();

            var objectValue = {
                    policyApply: policyApply,
                    salary: salary,
                    calculateOnSalary: calculateOnSalary,
                    salaryInsurance: salaryInsurance,
                    area: area,
                    personDependent: personDependent
            };
            return objectValue;
        }

        function FormatNumber(num) {
            return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,")
        }
    });
</script>

